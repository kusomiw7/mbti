<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>MBTIäººæ ¼æ¸¬é©— | å®Œæ•´å°ˆæ¥­ç‰ˆ</title>
    
    <!-- Google AdSense -->
    <meta name="google-adsense-account" content="ca-pub-2895749032536610">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2895749032536610" crossorigin="anonymous"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* æ‰‹æ©Ÿå„ªåŒ– */
        @media (max-width: 768px) {
            .mobile-ad { 
                min-height: 280px !important; 
                margin: 20px 0;
            }
            .quiz-container { padding: 1rem !important; }
            .question-text { font-size: 1.1rem !important; }
            .option-btn { padding: 0.8rem !important; margin: 0.4rem 0 !important; }
            .ad-container { 
                height: auto !important; 
                min-height: 280px !important;
                max-height: 320px !important;
                overflow: hidden;
            }
            .result-container {
                max-height: calc(100vh - 200px) !important;
                overflow-y: auto;
            }
        }
        
        /* å‹•ç•«æ•ˆæœ */
        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        
        /* é€²åº¦æ¢ */
        .progress-bar {
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4f46e5, #818cf8);
            transition: width 0.5s ease;
        }
        
        /* æŒ‰éˆ•æ¨£å¼ */
        .btn-primary {
            background: linear-gradient(135deg, #4f46e5, #3730a3);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.3s;
        }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(79, 70, 229, 0.3); }
        
        .btn-unlock {
            background: linear-gradient(135deg, #f97316, #ea580c);
            color: white;
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-weight: 700;
            transition: all 0.3s;
        }
        .btn-unlock:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(249, 115, 22, 0.3); }
        
        /* å»£å‘Šå®¹å™¨ */
        .ad-container {
            width: 100%;
            height: 280px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f9fafb;
            border: 1px dashed #d1d5db;
            border-radius: 12px;
            overflow: hidden;
            margin: 1rem 0;
        }
        
        /* å…è²¬è²æ˜ */
        .ad-disclaimer {
            font-size: 0.75rem;
            color: #6b7280;
            text-align: center;
            margin-top: 0.5rem;
            padding: 0.5rem;
            background: #f3f4f6;
            border-radius: 0.5rem;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-gray-50 to-gray-100 min-h-screen">
    <div class="max-w-4xl mx-auto p-3 md:p-4">
        <!-- æ¨™é¡Œ -->
        <header class="text-center mb-6 mt-2">
            <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-2">ğŸ­ MBTI äººæ ¼æ¸¬é©—ç³»çµ±</h1>
            <p class="text-gray-600 text-sm md:text-base max-w-2xl mx-auto">æ¢ç´¢çœŸå¯¦è‡ªæˆ‘ï¼Œå…è²»æ¸¬è©¦16å‹äººæ ¼</p>
            <div class="ad-disclaimer mt-2">
                æœ¬ç¶²ç«™ä½¿ç”¨å»£å‘Šæ”¯æŒå…è²»æœå‹™ï¼Œéƒ¨åˆ†åŠŸèƒ½éœ€ç¬¬ä¸‰æ–¹äº’å‹•è§£é–
            </div>
        </header>
        
        <!-- ä¸»å¡ç‰‡ -->
        <div class="bg-white rounded-2xl shadow-xl overflow-hidden">
            <!-- æ¨™ç±¤é  -->
            <div class="flex border-b border-gray-200">
                <button onclick="switchTab('basic')" id="tab-basic" class="flex-1 py-3 text-center font-semibold bg-indigo-600 text-white">
                    åŸºæœ¬æ¸¬é©— (16é¡Œ)
                </button>
                <button onclick="switchTab('expert')" id="tab-expert" class="flex-1 py-3 text-center font-semibold text-gray-600 hover:bg-gray-50">
                    å°ˆå®¶æ¸¬é©— (69é¡Œ)
                </button>
                <button onclick="switchTab('pro')" id="tab-pro" class="flex-1 py-3 text-center font-semibold text-gray-600 hover:bg-gray-50">
                    ç²¾æº– Pro (120é¡Œ)
                </button>
            </div>
            
            <!-- å…§å®¹å€ -->
            <div id="content-area" class="p-3 md:p-6 min-h-[400px]">
                æ­£åœ¨è¼‰å…¥...
            </div>
        </div>
        
        <!-- Google AdSense å»£å‘Šå€ -->
        <div class="mt-4">
            <div class="ad-container">
                <div id="google-ad">
                    <!-- Google AdSense å»£å‘Šè¼‰å…¥å€ -->
                </div>
            </div>
            <div class="ad-disclaimer">
                Google æä¾›çš„å»£å‘Šå…§å®¹ï¼Œèˆ‡æœ¬ç¶²ç«™ç„¡é—œ
            </div>
        </div>
    </div>

<script>
// ==================== å…¨å±€ç‹€æ…‹ ====================
let currentTab = 'basic';
let quizState = {
    basic: {
        currentQuestion: 0,
        answers: new Array(16).fill(null),
        completed: false,
        result: null
    },
    expert: { 
        unlocked: false, 
        currentQuestion: 0, 
        answers: new Array(69).fill(null),
        completed: false,
        result: null 
    },
    pro: { 
        unlocked: false, 
        currentQuestion: 0, 
        answers: new Array(120).fill(null),
        completed: false,
        result: null 
    }
};

// ==================== MBTI é¡Œç›®åº« ====================
const BASIC_QUESTIONS = [
    { id: 1, text: "ç¶“éä¸€æ•´å¤©çš„å·¥ä½œæˆ–ç¤¾äº¤æ´»å‹•å¾Œï¼Œæ‚¨é€šå¸¸çš„æ„Ÿè¦ºæ˜¯ï¼Ÿ", options: ["ç²¾åŠ›å……æ²›ï¼Œé‚„æƒ³ç¹¼çºŒæ´»å‹•æˆ–äº¤è«‡ (E)", "æ„Ÿåˆ°ç–²æ†Šï¼Œéœ€è¦ç¨è™•ä¾†å……é›» (I)"], dichotomy: 'EI' },
    { id: 2, text: "åœ¨ä¸€å€‹å……æ»¿äººçš„å ´åˆä¸­ï¼Œæ‚¨å‚¾å‘æ–¼ï¼Ÿ", options: ["ç©æ¥µåƒèˆ‡ä¸¦æ˜¯ä¸»è¦çš„ç™¼è¨€äººä¹‹ä¸€ (E)", "ä¿æŒè§€å¯Ÿï¼Œæ›´å–œæ­¡ä¸€å°ä¸€æˆ–å°çµ„æ·±åº¦äº¤æµ (I)"], dichotomy: 'EI' },
    { id: 3, text: "æ‚¨æ›´å–œæ­¡è™•ç†å“ªç¨®è¨Šæ¯ï¼Ÿ", options: ["åœ¨å¤–ç•Œç™¼ç”Ÿçš„ã€å…·é«”çš„ã€å¯è¦‹çš„æ´»å‹• (E)", "åœ¨è…¦æµ·ä¸­ç™¼ç”Ÿçš„ã€å…§çœçš„ã€æƒ³åƒä¸­çš„æ´»å‹• (I)"], dichotomy: 'EI' },
    { id: 4, text: "æ‚¨èªç‚ºå¤šæ•¸äººå°æ‚¨çš„ç­è§£ç¨‹åº¦æ˜¯ï¼Ÿ", options: ["ç›¸ç•¶ä¸éŒ¯ï¼Œå› ç‚ºæ‚¨å¾ˆé–‹æ”¾ (E)", "ä¸å¤ æ·±å…¥ï¼Œå› ç‚ºæ‚¨è¼ƒç‚ºå…§æ–‚ (I)"], dichotomy: 'EI' },
    { id: 5, text: "åœ¨å­¸ç¿’æ–°æ±è¥¿æ™‚ï¼Œæ‚¨æ›´é‡è¦–ï¼Ÿ", options: ["å¯¦éš›çš„æ‡‰ç”¨ã€ç•¶å‰çš„ç´°ç¯€å’Œæ˜ç¢ºçš„æ­¥é©Ÿ (S)", "ç†è«–åŸºç¤ã€æŠ½è±¡æ¦‚å¿µå’Œæœªä¾†çš„å¯èƒ½æ€§ (N)"], dichotomy: 'SN' },
    { id: 6, text: "æ‚¨æœ€äº«å—çš„å°è©±å…§å®¹æ˜¯é—œæ–¼ï¼Ÿ", options: ["æ‰‹é‚Šçš„ä»»å‹™ã€çœŸå¯¦ç™¼ç”Ÿçš„äº‹ä»¶æˆ–å¯¦ç”¨è³‡è¨Š (S)", "å“²å­¸ã€é è¦‹ã€æ–°ç©çš„æƒ³æ³•æˆ–æ¯”å–» (N)"], dichotomy: 'SN' },
    { id: 7, text: "æ‚¨é€šå¸¸ä¿¡ä»»ï¼Ÿ", options: ["æ‚¨çš„éå»ç¶“é©—å’Œç¶“éé©—è­‰çš„äº‹å¯¦ (S)", "æ‚¨çš„éˆæ„Ÿã€ç›´è¦ºæˆ–å°æ¨¡å¼çš„æ´å¯Ÿ (N)"], dichotomy: 'SN' },
    { id: 8, text: "æ‚¨èªç‚ºè‡ªå·±æ˜¯ä¸€å€‹ï¼Ÿ", options: ["å‹™å¯¦ä¸”è…³è¸å¯¦åœ°çš„äºº (S)", "å¯Œæœ‰æƒ³åƒåŠ›å’ŒåŸå‰µæ€§çš„äºº (N)"], dichotomy: 'SN' },
    { id: 9, text: "ç•¶æ‚¨åšé‡å¤§æ±ºå®šæ™‚ï¼Œæ‚¨æœƒï¼Ÿ", options: ["ä¿æŒå®¢è§€ï¼Œæ¬Šè¡¡é‚è¼¯ã€æ•ˆç‡å’Œåˆ©å¼Š (T)", "è€ƒæ…®å°ä»–äººçš„å½±éŸ¿ã€æƒ…æ„Ÿåƒ¹å€¼å’Œå€‹äººæƒ…æ³ (F)"], dichotomy: 'TF' },
    { id: 10, text: "åœ¨æ‰¹è©•æˆ–æå‡ºåå°æ„è¦‹æ™‚ï¼Œæ‚¨å‚¾å‘æ–¼ï¼Ÿ", options: ["ç›´æ¥ã€å¦èª ï¼Œå°ˆæ³¨æ–¼å•é¡Œçš„è§£æ±º (T)", "æº«å’Œã€åœ“æ»‘ï¼Œç›¡é‡ç¶­è­·å’Œè«§çš„é—œä¿‚ (F)"], dichotomy: 'TF' },
    { id: 11, text: "æ‚¨èªç‚ºç¨±è®šä¸€å€‹äººæœ€å¥½æ˜¯ç¨±è®šå…¶ï¼Ÿ", options: ["æ™ºæ…§ã€é‚è¼¯æ€ç¶­æˆ–å…¬å¹³æ€§ (T)", "å–„è‰¯ã€åŒç†å¿ƒæˆ–ç†±å¿ƒåŠ©äºº (F)"], dichotomy: 'TF' },
    { id: 12, text: "æ‚¨èªç‚ºå…¬æ­£çš„æ±ºå®šæ‡‰è©²åŸºæ–¼ï¼Ÿ", options: ["ä¸€å¥—çµ±ä¸€ã€éå€‹äººçš„æ¨™æº– (T)", "æ¯å€‹äººçš„ç¨ç‰¹éœ€æ±‚å’Œåƒ¹å€¼è§€ (F)"], dichotomy: 'TF' },
    { id: 13, text: "å°æ–¼å‡æœŸæˆ–å¤§å°ˆæ¡ˆï¼Œæ‚¨å‚¾å‘æ–¼ï¼Ÿ", options: ["æå‰è¨ˆç•«ã€ç¢ºå®šç´°ç¯€ä¸¦æŒ‰æ™‚å®Œæˆ (J)", "ä¿æŒå½ˆæ€§ã€é–‹æ”¾é¸æ“‡ï¼Œä¸¦åœ¨ç•¶ä¸‹æ±ºå®š (P)"], dichotomy: 'JP' },
    { id: 14, text: "æ‚¨é€šå¸¸è¦ºå¾—æˆªæ­¢æ—¥æœŸæ˜¯ï¼Ÿ", options: ["å¿…é ˆéµå®ˆçš„ï¼Œé€™è®“æ‚¨æœ‰æ¢ç†åœ°å·¥ä½œ (J)", "å¯ä»¥èª¿æ•´çš„ï¼Œé€™è®“æ‚¨èƒ½å¤ é©æ‡‰è®ŠåŒ– (P)"], dichotomy: 'JP' },
    { id: 15, text: "æ‚¨çš„å·¥ä½œæˆ–ç”Ÿæ´»ç©ºé–“é€šå¸¸æ˜¯ï¼Ÿ", options: ["æ•´æ½”ã€æœ‰åºï¼Œæ‰€æœ‰æ±è¥¿éƒ½æœ‰å›ºå®šçš„ä½ç½® (J)", "éš¨æ€§ã€æœ‰æ©Ÿï¼Œé›œäº‚ä½†æ‚¨çŸ¥é“æ±è¥¿åœ¨å“ª (P)"], dichotomy: 'JP' },
    { id: 16, text: "æ‚¨å°‡ç”Ÿæ´»è¦–ç‚ºï¼Ÿ", options: ["éœ€è¦è¢«æ§åˆ¶ã€çµ„ç¹”å’Œåšå‡ºçµè«–çš„çµæ§‹ (J)", "éœ€è¦è¢«é«”é©—ã€æ¢ç´¢å’Œä¿æŒé–‹æ”¾çš„éç¨‹ (P)"], dichotomy: 'JP' },
];

// ==================== å°ˆå®¶æ¸¬é©— 69é¡Œ ====================
const EXPERT_QUESTIONS = generateExpertQuestions();

function generateExpertQuestions() {
    const questions = [];
    const categories = {
        EI: [
            "ç¤¾äº¤èƒ½é‡ä¾†æº", "ç¨è™•æ„Ÿå—", "æ·±åº¦æ€è€ƒæ–¹å¼", "æ³¨æ„åŠ›æ–¹å‘", 
            "èƒ½é‡æ¢å¾©æ–¹å¼", "ç¤¾äº¤åå¥½", "æ€è€ƒè¡¨é”", "æ±ºç­–åƒèˆ‡",
            "åœ˜éšŠäº’å‹•", "å­¸ç¿’æ–¹å¼", "å£“åŠ›åæ‡‰", "å‰µæ„è¡¨é”",
            "è¡çªè™•ç†", "é ˜å°é¢¨æ ¼", "æºé€šæ·±åº¦", "åæ€ç¿’æ…£",
            "æ–°ç’°å¢ƒé©æ‡‰", "å°ˆæ³¨åŠ›ä¾†æº", "æƒ…æ„Ÿè¡¨é”", "è³‡è¨Šè™•ç†",
            "è¨ˆç•«åŸ·è¡Œ", "é¢¨éšªæ‰¿å—", "äººéš›é‚Šç•Œ", "è‡ªæˆ‘èªåŒ",
            "åƒ¹å€¼è§€å±•ç¾", "æˆå°±æ„Ÿä¾†æº", "ä¼‘æ¯æ–¹å¼", "å•é¡Œè§£æ±º",
            "å­¸ç¿’å‹•æ©Ÿ", "æˆé•·æ–¹å‘", "å·¥ä½œç’°å¢ƒåå¥½", "æºé€šé »ç‡",
            "å‰µæ„è§¸ç™¼", "æƒ…ç·’ç®¡ç†", "æ±ºç­–é€Ÿåº¦", "åˆä½œæ–¹å¼"
        ],
        SN: [
            "ç¾å¯¦æ„ŸçŸ¥", "æœªä¾†æƒ³åƒ", "ç´°ç¯€é—œæ³¨", "æ¨¡å¼è­˜åˆ¥",
            "äº‹å¯¦è¨˜æ†¶", "æ¦‚å¿µç†è§£", "å…·é«”æ€è€ƒ", "æŠ½è±¡æ€ç¶­",
            "å¯¦éš›æ‡‰ç”¨", "ç†è«–æ¢ç´¢", "è§€å¯ŸåŠ›", "æ´å¯ŸåŠ›",
            "ç¶“é©—ä¾è³´", "éˆæ„Ÿä¾†æº", "ç¾å¯¦è©•ä¼°", "å¯èƒ½æ€§æ¢ç´¢",
            "å‚³çµ±åƒ¹å€¼", "å‰µæ–°æ€ç¶­", "å¯¦ç”¨ä¸»ç¾©", "ç†æƒ³ä¸»ç¾©",
            "ç•¶ä¸‹å°ˆæ³¨", "é•·é è¦åŠƒ", "æ„Ÿå®˜é«”é©—", "ç›´è¦ºåˆ¤æ–·",
            "æ•¸æ“šåˆ†æ", "è¶¨å‹¢é æ¸¬", "æ­¥é©ŸåŸ·è¡Œ", "æ•´é«”ç†è§£",
            "ç¾å¯¦é™åˆ¶", "æ½›èƒ½é–‹ç™¼", "è³‡è¨Šè™•ç†", "å­¸ç¿’æ–¹æ³•",
            "å•é¡Œåˆ†æ", "æ±ºç­–ä¾æ“š", "å·¥ä½œæ–¹å¼", "å‰µæ„è¡¨é”"
        ],
        TF: [
            "æ±ºç­–åŸºç¤", "åƒ¹å€¼åˆ¤æ–·", "å•é¡Œåˆ†æ", "æƒ…æ„Ÿè€ƒé‡",
            "å…¬å¹³æ¨™æº–", "åŒç†å¿ƒè¡¨ç¾", "é‚è¼¯æ¨ç†", "å’Œè«§ç¶­è­·",
            "å®¢è§€è©•åƒ¹", "ä¸»è§€æ„Ÿå—", "åŸå‰‡å …æŒ", "é—œä¿‚ç¶­è­·",
            "æ•ˆç‡å„ªå…ˆ", "äººæƒ…å„ªå…ˆ", "æ‰¹åˆ¤æ€ç¶­", "æ”¯æŒæ…‹åº¦",
            "ç›®æ¨™å°å‘", "éç¨‹é‡è¦–", "ç†æ€§åˆ†æ", "æ„Ÿæ€§ç†è§£",
            "è¦å‰‡éµå®ˆ", "ä¾‹å¤–è€ƒæ…®", "ç«¶çˆ­æ„è­˜", "åˆä½œç²¾ç¥",
            "ç¨ç«‹åˆ¤æ–·", "ç¾¤é«”å…±è­˜", "æˆæœè©•ä¼°", "æƒ…æ„Ÿåƒ¹å€¼",
            "è²¬ä»»æ‰¿æ“”", "é—œæ‡·è¡¨é”", "è¡çªè§£æ±º", "æºé€šé¢¨æ ¼",
            "åœ˜éšŠç®¡ç†", "ç¸¾æ•ˆè©•ä¼°", "å‹•æ©Ÿæ¿€ç™¼", "äººéš›äº’å‹•"
        ],
        JP: [
            "ç”Ÿæ´»çµæ§‹", "éˆæ´»æ€§", "æ™‚é–“ç®¡ç†", "è‡ªç™¼æ€§",
            "çµ„ç¹”ç¨‹åº¦", "é©æ‡‰èƒ½åŠ›", "è¨ˆç•«åˆ¶å®š", "å³èˆˆç™¼æ®",
            "ç›®æ¨™è¨­å®š", "æ©ŸæœƒæŠŠæ¡", "è¦å¾‹æ€§", "è®ŠåŒ–æ‡‰å°",
            "æ±ºç­–é€Ÿåº¦", "é¸æ“‡é–‹æ”¾", "æ§åˆ¶éœ€æ±‚", "è‡ªç”±éœ€æ±‚",
            "å®Œæˆå°å‘", "æ¢ç´¢å°å‘", "ç³»çµ±å»ºç«‹", "é«”é©—è¿½æ±‚",
            "è²¬ä»»æ‰¿æ“”", "å£“åŠ›åæ‡‰", "å·¥ä½œæ–¹å¼", "ä¼‘é–’æ–¹å¼",
            "è³‡è¨Šæ”¶é›†", "çµè«–å½¢æˆ", "å°ˆæ¡ˆç®¡ç†", "å‰µæ„éç¨‹",
            "å­¸ç¿’çµæ§‹", "æˆé•·è·¯å¾‘", "ç©ºé–“ç®¡ç†", "å„ªå…ˆæ’åº",
            "ç¿’æ…£é¤Šæˆ", "æ‡‰è®Šèƒ½åŠ›", "çµæœå°å‘", "éç¨‹äº«å—"
        ]
    };

    let questionId = 1;
    
    // æ¯å€‹ç¶­åº¦ç”Ÿæˆ17é¡Œï¼Œå…±68é¡Œ
    Object.keys(categories).forEach((dichotomy) => {
        const dimCategories = categories[dichotomy];
        for (let i = 0; i < 17; i++) {
            const category = dimCategories[i % dimCategories.length];
            questions.push({
                id: questionId++,
                text: `é—œæ–¼${category}ï¼Œæ‚¨é€šå¸¸æœƒï¼š`,
                options: [
                    getExpertOption(dichotomy, 0, category),
                    getExpertOption(dichotomy, 1, category)
                ],
                dichotomy: dichotomy
            });
        }
    });
    
    // åŠ ä¸€é¡Œç¶œåˆé¡Œ
    questions.push({
        id: questionId,
        text: "æ•´é«”è€Œè¨€ï¼Œæ‚¨èªç‚ºè‡ªå·±æ›´å‚¾å‘æ–¼å“ªç¨®ç”Ÿæ´»æ–¹å¼ï¼Ÿ",
        options: ["çµæ§‹åŒ–ã€æœ‰çµ„ç¹”ã€å¯é æ¸¬çš„ç”Ÿæ´»", "éˆæ´»ã€é–‹æ”¾ã€å……æ»¿å¯èƒ½æ€§çš„ç”Ÿæ´»"],
        dichotomy: 'JP'
    });
    
    return questions;
}

function getExpertOption(dichotomy, optionIndex, category) {
    const optionTexts = {
        'EI': [
            'å‚¾å‘æ–¼èˆ‡ä»–äººäº’å‹•ï¼Œå¾å¤–éƒ¨ä¸–ç•Œç²å¾—èƒ½é‡',
            'å‚¾å‘æ–¼ç¨è™•åæ€ï¼Œå¾å…§å¿ƒä¸–ç•Œç²å¾—èƒ½é‡'
        ],
        'SN': [
            'å°ˆæ³¨æ–¼å…·é«”äº‹å¯¦å’Œå¯¦éš›ç¶“é©—',
            'é—œæ³¨æŠ½è±¡æ¦‚å¿µå’Œæœªä¾†å¯èƒ½æ€§'
        ],
        'TF': [
            'åŸºæ–¼é‚è¼¯åˆ†æå’Œå®¢è§€äº‹å¯¦åšæ±ºå®š',
            'è€ƒæ…®æƒ…æ„Ÿå½±éŸ¿å’Œå€‹äººåƒ¹å€¼è§€åšæ±ºå®š'
        ],
        'JP': [
            'å–œæ­¡æœ‰è¨ˆåŠƒã€æœ‰çµæ§‹çš„ç”Ÿæ´»æ–¹å¼',
            'åå¥½éˆæ´»ã€é–‹æ”¾çš„ç”Ÿæ´»æ–¹å¼'
        ]
    };
    
    return optionTexts[dichotomy][optionIndex];
}

// ==================== Proæ¸¬é©— 120é¡Œ ====================
const PRO_QUESTIONS = generateProQuestions();

function generateProQuestions() {
    const questions = [];
    const detailedCategories = {
        EI: [
            "èƒ½é‡ç²å–æ–¹å¼", "ç¤¾äº¤äº’å‹•åå¥½", "æ³¨æ„åŠ›æ–¹å‘", "æ€è€ƒè¡¨é”æ–¹å¼",
            "ä¼‘æ¯æ¢å¾©æ¨¡å¼", "å­¸ç¿’æœ€ä½³ç’°å¢ƒ", "å£“åŠ›é‡‹æ”¾é€”å¾‘", "å‰µæ„æ¿€ç™¼æ–¹å¼",
            "æ±ºç­–åƒèˆ‡ç¨‹åº¦", "åœ˜éšŠåˆä½œé¢¨æ ¼", "æºé€šé »ç‡åå¥½", "æƒ…æ„Ÿè¡¨é”æ¨¡å¼",
            "è‡ªæˆ‘åæ€ç¿’æ…£", "æ–°ç’°å¢ƒé©æ‡‰åŠ›", "è¡çªè™•ç†æ–¹å¼", "é ˜å°é¢¨æ ¼å‚¾å‘",
            "è³‡è¨Šå¸æ”¶æ–¹å¼", "å•é¡Œè§£æ±ºé€”å¾‘", "æˆå°±æ„Ÿä¾†æº", "å·¥ä½œç’°å¢ƒéœ€æ±‚",
            "æ™‚é–“åˆ†é…åå¥½", "äººéš›äº’å‹•æ·±åº¦", "é¢¨éšªæ‰¿å—æ…‹åº¦", "è®ŠåŒ–é©æ‡‰èƒ½åŠ›",
            "ç¨ç«‹å·¥ä½œèƒ½åŠ›", "ç¾¤é«”æ´»å‹•åƒèˆ‡", "æ·±åº¦æ€è€ƒæ¨¡å¼", "å³æ™‚åæ‡‰èƒ½åŠ›",
            "é•·æœŸè¦åŠƒèƒ½åŠ›", "çŸ­æœŸåŸ·è¡Œåå¥½"
        ],
        SN: [
            "ç¾å¯¦æ„ŸçŸ¥æ–¹å¼", "æœªä¾†è¦åŠƒèƒ½åŠ›", "ç´°ç¯€è™•ç†å‚¾å‘", "æ•´é«”ç†è§£æ¨¡å¼",
            "è¨˜æ†¶ç‰¹é»", "å­¸ç¿’æ–¹æ³•åå¥½", "å•é¡Œåˆ†æè§’åº¦", "å‰µæ„æ€ç¶­æ–¹å¼",
            "è³‡è¨Šç¯©é¸æ¨™æº–", "æ¨¡å¼è­˜åˆ¥èƒ½åŠ›", "ç¶“é©—æ‡‰ç”¨ç¨‹åº¦", "ç†è«–æ¢ç´¢èˆˆè¶£",
            "å¯¦éš›æ“ä½œèƒ½åŠ›", "æŠ½è±¡æ€è€ƒèƒ½åŠ›", "è§€å¯Ÿæ•éŠ³åº¦", "æ´å¯ŸåŠ›æ·±åº¦",
            "å‚³çµ±åƒ¹å€¼è§€", "å‰µæ–°æ¥å—åº¦", "å¯¦ç”¨ä¸»ç¾©ç¨‹åº¦", "ç†æƒ³ä¸»ç¾©å‚¾å‘",
            "ç•¶ä¸‹å°ˆæ³¨åŠ›", "é•·æœŸå±•æœ›èƒ½åŠ›", "æ„Ÿå®˜é«”é©—åå¥½", "ç›´è¦ºé‹ç”¨é »ç‡",
            "æ•¸æ“šåˆ†æèƒ½åŠ›", "è¶¨å‹¢é æ¸¬ä¿¡å¿ƒ", "æ­¥é©ŸåŸ·è¡Œåš´è¬¹åº¦", "æ•´é«”æŠŠæ¡èƒ½åŠ›",
            "ç¾å¯¦è©•ä¼°æº–ç¢ºåº¦", "æ½›åŠ›ç™¼æ˜èƒ½åŠ›"
        ],
        TF: [
            "æ±ºç­–ä¾æ“šæ¨™æº–", "åƒ¹å€¼è§€æ ¸å¿ƒ", "å•é¡Œè§£æ±ºé‚è¼¯", "æƒ…æ„Ÿè€ƒé‡ç¨‹åº¦",
            "å…¬å¹³æ€§å®šç¾©", "åŒç†å¿ƒè¡¨ç¾", "ç†æ€§åˆ†æèƒ½åŠ›", "å’Œè«§ç¶­è­·éœ€æ±‚",
            "å®¢è§€è©•åƒ¹æ¨™æº–", "ä¸»è§€æ„Ÿå—å½±éŸ¿", "åŸå‰‡å …æŒç¨‹åº¦", "é—œä¿‚é‡è¦–ç¨‹åº¦",
            "æ•ˆç‡å„ªå…ˆç­‰ç´š", "äººæƒ…è€ƒé‡å› ç´ ", "æ‰¹åˆ¤æ€ç¶­èƒ½åŠ›", "æ”¯æŒæ…‹åº¦å±•ç¾",
            "ç›®æ¨™å°å‘å¼·åº¦", "éç¨‹äº«å—ç¨‹åº¦", "é‚è¼¯æ¨ç†èƒ½åŠ›", "æƒ…æ„Ÿç†è§£æ·±åº¦",
            "è¦å‰‡éµå®ˆç¨‹åº¦", "ä¾‹å¤–è™•ç†èƒ½åŠ›", "ç«¶çˆ­æ„è­˜å¼·åº¦", "åˆä½œç²¾ç¥è¡¨ç¾",
            "ç¨ç«‹åˆ¤æ–·ä¿¡å¿ƒ", "ç¾¤é«”å”èª¿èƒ½åŠ›", "æˆæœè©•ä¼°æ¨™æº–", "æƒ…æ„Ÿåƒ¹å€¼æ¬Šè¡¡",
            "è²¬ä»»æ‰¿æ“”æ„é¡˜", "é—œæ‡·è¡¨é”æ–¹å¼"
        ],
        JP: [
            "ç”Ÿæ´»çµæ§‹åŒ–ç¨‹åº¦", "éˆæ´»æ€§è¡¨ç¾", "æ™‚é–“ç®¡ç†é¢¨æ ¼", "è‡ªç™¼æ€§å‚¾å‘",
            "çµ„ç¹”èƒ½åŠ›æ°´å¹³", "é©æ‡‰è®ŠåŒ–èƒ½åŠ›", "è¨ˆç•«åˆ¶å®šç¿’æ…£", "å³èˆˆç™¼æ®ä¿¡å¿ƒ",
            "ç›®æ¨™è¨­å®šæ˜ç¢ºåº¦", "æ©ŸæœƒæŠŠæ¡èƒ½åŠ›", "è¦å¾‹æ€§éœ€æ±‚", "è®ŠåŒ–æ‡‰å°æ–¹å¼",
            "æ±ºç­–é€Ÿåº¦åå¥½", "é¸æ“‡é–‹æ”¾ç¨‹åº¦", "æ§åˆ¶éœ€æ±‚å¼·åº¦", "è‡ªç”±è¿½æ±‚ç¨‹åº¦",
            "å®Œæˆå°å‘ç¨‹åº¦", "æ¢ç´¢æ¨‚è¶£äº«å—", "ç³»çµ±å»ºç«‹èƒ½åŠ›", "é«”é©—è¿½æ±‚ç†±æƒ…",
            "è²¬ä»»æ‰¿æ“”æ–¹å¼", "å£“åŠ›åæ‡‰æ¨¡å¼", "å·¥ä½œæ•ˆç‡é¢¨æ ¼", "ä¼‘é–’å®‰æ’åå¥½",
            "è³‡è¨Šæ”¶é›†ç¯„åœ", "çµè«–å½¢æˆé€Ÿåº¦", "å°ˆæ¡ˆç®¡ç†èƒ½åŠ›", "å‰µæ„éç¨‹äº«å—",
            "å­¸ç¿’çµæ§‹éœ€æ±‚", "æˆé•·è·¯å¾‘è¦åŠƒ"
        ]
    };

    let questionId = 1;
    
    // æ¯å€‹ç¶­åº¦ç”Ÿæˆ30é¡Œï¼Œå…±120é¡Œ
    Object.keys(detailedCategories).forEach((dichotomy) => {
        const dimCategories = detailedCategories[dichotomy];
        for (let i = 0; i < 30; i++) {
            const category = dimCategories[i % dimCategories.length];
            const isFirstOption = Math.random() > 0.5;
            
            questions.push({
                id: questionId++,
                text: `åœ¨${category}æ–¹é¢ï¼Œæ‚¨é€šå¸¸ï¼š`,
                options: isFirstOption ? 
                    [
                        `æ›´å‚¾å‘æ–¼${getProOptionText(dichotomy, 0)}`,
                        `æ›´å‚¾å‘æ–¼${getProOptionText(dichotomy, 1)}`
                    ] : [
                        `æ›´æ³¨é‡${getProOptionText(dichotomy, 1)}`,
                        `æ›´æ³¨é‡${getProOptionText(dichotomy, 0)}`
                    ],
                dichotomy: dichotomy
            });
        }
    });
    
    return questions;
}

function getProOptionText(dichotomy, optionIndex) {
    const optionTexts = {
        'EI': [
            'èˆ‡ä»–äººäº’å‹•å’Œå¤–éƒ¨ä¸–ç•Œçš„åˆºæ¿€',
            'å€‹äººå…§çœå’Œç¨è™•æ™‚çš„åæ€'
        ],
        'SN': [
            'å…·é«”äº‹å¯¦ã€å¯¦éš›ç¶“é©—å’Œå¯é©—è­‰çš„æ•¸æ“š',
            'æŠ½è±¡æ¦‚å¿µã€æœªä¾†å¯èƒ½æ€§å’Œæ•´é«”æ¨¡å¼'
        ],
        'TF': [
            'é‚è¼¯åˆ†æã€å®¢è§€æ¨™æº–å’Œæ•ˆç‡è€ƒé‡',
            'æƒ…æ„Ÿå½±éŸ¿ã€äººéš›å’Œè«§å’Œåƒ¹å€¼è§€ä¸€è‡´æ€§'
        ],
        'JP': [
            'è¨ˆç•«åˆ¶å®šã€çµæ§‹åŒ–å’Œçµæœå°å‘',
            'ä¿æŒé–‹æ”¾ã€éˆæ´»æ‡‰è®Šå’Œéç¨‹é«”é©—'
        ]
    };
    
    return optionTexts[dichotomy][optionIndex];
}

// ==================== è§£é–æµç¨‹ï¼ˆæœ€å®‰å…¨åˆè¦ç‰ˆæœ¬ï¼‰ ====================
let unlockInterval = null;
let isHilltopAdsLoaded = { expert: false, pro: false };

function loadHilltopAds(type) {
    if (isHilltopAdsLoaded[type]) return;
    
    let scriptSrc = '';
    
    // æ ¹æ“šæ‚¨æª”æ¡ˆä¸­ä½¿ç”¨çš„ä¸åŒ Hilltopads è…³æœ¬é€²è¡Œå€åˆ†
    if (type === 'expert') {
        // å°ˆå®¶æ¸¬é©— Hilltopads è…³æœ¬
        scriptSrc = 'https://starry-perception.com/ctD.9M6Nbh2x5SltS-WzQy9-Naj/chywNGjdUF2QOTSX0y2ENwzIIA2GN/TmcTwl';
    } else if (type === 'pro') {
        // Proæ¸¬é©— Hilltopads è…³æœ¬
        scriptSrc = 'https://starry-perception.com/c.DX9y6jbT2/5Zl_StWYQa9dN/jPc_yZN/jeUG2FN/yV0o2NNNz/I/2/N/TKYx4_';
    }
    
    if (scriptSrc) {
        const script = document.createElement('script');
        script.src = scriptSrc;
        script.async = true;
        script.referrerPolicy = 'no-referrer-when-downgrade';
        document.head.appendChild(script);
        console.log(`Hilltopads å»£å‘Š (${type}) åœ¨å…§å®¹è§£é–å¾Œè¢«å‹•è¼‰å…¥`);
        isHilltopAdsLoaded[type] = true;
    }
}

function renderLockedPage(type, title, description) {
    // æ¯æ¬¡æ¸²æŸ“å‰æ¸…ç†èˆŠçš„è¨ˆæ™‚å™¨
    if (unlockInterval) {
        clearInterval(unlockInterval);
    }

    // ğŸŒŸ é—œéµï¼šè‡ªå‹•å•Ÿå‹•å€’æ•¸è¨ˆæ™‚ï¼Œç„¡éœ€ç”¨æˆ¶é»æ“Š
    unlockAfterCountdown(type, 10);
    
    return `
        <div class="fade-in text-center py-8">
            <div class="w-16 h-16 md:w-20 md:h-20 mx-auto mb-6 rounded-full bg-gradient-to-r from-gray-200 to-gray-300 flex items-center justify-center">
                <span class="text-3xl">ğŸ”’</span>
            </div>
            <h2 class="text-xl md:text-2xl font-bold text-gray-800 mb-3">${title}</h2>
            <p class="text-gray-600 text-sm md:text-base max-w-xl mx-auto mb-8">${description}</p>
            
            <div class="max-w-md mx-auto">
                <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-2xl border border-blue-200 mb-8">
                    <h3 class="text-lg md:text-xl font-bold text-gray-800 mb-4">å…§å®¹å°‡è‡ªå‹•è§£é–</h3>
                    <p class="text-gray-700 mb-6 text-sm md:text-base">
                        æ‚¨ç„¡éœ€é»æ“Šã€‚å…§å®¹å°‡åœ¨ä¸‹æ–¹å€’æ•¸çµæŸå¾Œç«‹å³é¡¯ç¤ºã€‚
                        <span class="block font-semibold mt-2">æ„Ÿè¬æ‚¨æ”¯æŒå…è²»æœå‹™ï¼</span>
                    </p>
                    
                    <div id="unlock-timer" class="text-3xl font-bold text-indigo-600 pulse">
                        10 ç§’å¾Œè‡ªå‹•è§£é–...
                    </div>
                </div>
            </div>
        </div>
    `;
}

function unlockAfterCountdown(type, seconds) {
    let countdown = seconds;
    const timerElement = document.getElementById('unlock-timer');

    if (timerElement) {
        timerElement.innerHTML = `${countdown} ç§’å¾Œè‡ªå‹•è§£é–...`;
    }

    unlockInterval = setInterval(() => {
        countdown--;
        const currentTimerElement = document.getElementById('unlock-timer');
        
        if (countdown > 0) {
            if (currentTimerElement) {
                currentTimerElement.innerHTML = `${countdown} ç§’å¾Œè‡ªå‹•è§£é–...`;
            }
        } else {
            clearInterval(unlockInterval);
            if (currentTimerElement) {
                currentTimerElement.innerHTML = 'âœ… å…§å®¹å·²è§£é–ï¼';
                currentTimerElement.classList.remove('pulse');
            }

            // åŸ·è¡Œè§£é–
            if (type === 'expert') {
                quizState.expert.unlocked = true;
            } else if (type === 'pro') {
                quizState.pro.unlocked = true;
            }
            
            // ğŸŒŸ é—œéµï¼šå…§å®¹è§£é–å¾Œï¼Œè¼‰å…¥ Hilltopads è…³æœ¬
            loadHilltopAds(type);
            
            setTimeout(() => {
                renderContent(); // é‡æ–°æ¸²æŸ“åˆ°æ¸¬é©—é é¢
                // renderContent() å…§éƒ¨æœƒèª¿ç”¨ loadGoogleAds()
            }, 1000); // å»¶é² 1 ç§’ä»¥é¡¯ç¤ºè§£é–è¨Šæ¯
        }
    }, 1000);
}

// ç¢ºä¿ showUnlockPage åªæ˜¯åˆ‡æ›æ¨™ç±¤çš„å…¥å£
function showUnlockPage(type) {
    switchTab(type); 
}

// ==================== Google AdSense å»£å‘Š ====================
function loadGoogleAds() {
    // è¼‰å…¥Googleå»£å‘Š
    const googleAd = document.getElementById('google-ad');
    if (googleAd && !googleAd.querySelector('.adsbygoogle')) {
        googleAd.innerHTML = `
            <ins class="adsbygoogle"
                 style="display:block; width:100%; min-height:250px;"
                 data-ad-client="ca-pub-2895749032536610"
                 data-ad-slot="1132687996"
                 data-ad-format="auto"
                 data-full-width-responsive="true">
            </ins>
        `;
    }
    
    // æ¨é€å»£å‘Š
    setTimeout(() => {
        if (typeof adsbygoogle !== 'undefined') {
            try {
                (adsbygoogle = window.adsbygoogle || []).push({});
                console.log('Google AdSense å»£å‘Šå·²è¼‰å…¥');
            } catch (e) {
                console.log('Googleå»£å‘Šè¼‰å…¥ä¸­...');
            }
        }
    }, 500);
}

// ==================== æ¨™ç±¤åˆ‡æ› ====================
function switchTab(tabId) {
    currentTab = tabId;
    
    // æ›´æ–°æ¨™ç±¤æ¨£å¼
    document.querySelectorAll('[id^="tab-"]').forEach(btn => {
        btn.classList.remove('bg-indigo-600', 'text-white');
        btn.classList.add('text-gray-600', 'hover:bg-gray-50');
    });
    
    const activeBtn = document.getElementById(`tab-${tabId}`);
    activeBtn.classList.add('bg-indigo-600', 'text-white');
    activeBtn.classList.remove('text-gray-600', 'hover:bg-gray-50');
    
    // æ¸²æŸ“å…§å®¹
    renderContent();
}

// ==================== å…§å®¹æ¸²æŸ“å™¨ ====================
function renderContent() {
    const area = document.getElementById('content-area');
    
    if (currentTab === 'basic') {
        if (quizState.basic.completed) {
            area.innerHTML = renderResults('basic');
        } else {
            area.innerHTML = renderBasicQuiz();
        }
    } else if (currentTab === 'expert') {
        if (quizState.expert.unlocked) {
            if (quizState.expert.completed) {
                area.innerHTML = renderResults('expert');
            } else {
                area.innerHTML = renderExpertQuiz();
            }
        } else {
            area.innerHTML = renderLockedPage('expert', 'å°ˆå®¶æ¸¬é©—', '69é¡Œæ·±åº¦åˆ†æï¼ŒåŒ…å«è·æ¥­å»ºè­°ã€äººéš›é—œä¿‚æŒ‡å—å’Œå€‹äººæˆé•·è¨ˆåŠƒã€‚');
        }
    } else if (currentTab === 'pro') {
        if (quizState.pro.unlocked) {
            if (quizState.pro.completed) {
                area.innerHTML = renderResults('pro');
            } else {
                area.innerHTML = renderProQuiz();
            }
        } else {
            area.innerHTML = renderLockedPage('pro', 'ç²¾æº– Pro', '120é¡Œçµ‚æ¥µè©•ä¼°ï¼Œæœ€å…¨é¢çš„æ€§æ ¼å‰–æã€ç™¼å±•è·¯å¾‘å’Œå°ˆæ¥­å»ºè­°ã€‚');
        }
    }
    
    // è¼‰å…¥Googleå»£å‘Š
    loadGoogleAds();
}

// ==================== åŸºæœ¬æ¸¬é©—æ¸²æŸ“ ====================
function renderBasicQuiz() {
    const q = BASIC_QUESTIONS[quizState.basic.currentQuestion];
    const answered = quizState.basic.answers.filter(a => a !== null).length;
    const progress = (answered / 16) * 100;
    
    return `
        <div class="fade-in quiz-container">
            <div class="mb-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl md:text-2xl font-bold text-gray-800">åŸºæœ¬äººæ ¼æ¸¬é©—</h2>
                    <span class="bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full font-semibold text-sm">${answered}/16 é¡Œ</span>
                </div>
                
                <div class="mb-6">
                    <div class="flex justify-between text-sm text-gray-600 mb-2">
                        <span>æ¸¬é©—é€²åº¦</span>
                        <span>${Math.round(progress)}%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${progress}%"></div>
                    </div>
                </div>
                
                <div class="mb-8 p-4 md:p-6 bg-gradient-to-r from-indigo-50 to-blue-50 rounded-2xl border border-indigo-100">
                    <div class="flex items-start">
                        <div class="w-10 h-10 md:w-12 md:h-12 rounded-xl bg-indigo-100 flex items-center justify-center mr-3 md:mr-4">
                            <span class="text-lg md:text-xl font-bold text-indigo-700">${quizState.basic.currentQuestion + 1}</span>
                        </div>
                        <div class="flex-1">
                            <h3 class="text-lg md:text-xl font-semibold text-gray-800 mb-3">${q.text}</h3>
                            <div class="space-y-2 md:space-y-3">
                                ${q.options.map((option, idx) => `
                                    <button onclick="selectAnswer(${idx}, 'basic')" 
                                            class="w-full text-left p-3 md:p-4 rounded-xl border-2 transition-all duration-200 ${quizState.basic.answers[quizState.basic.currentQuestion] === idx ? 'border-indigo-500 bg-indigo-50 shadow-md' : 'border-gray-200 hover:border-indigo-300 hover:bg-gray-50'}">
                                        <div class="flex items-center">
                                            <div class="w-6 h-6 md:w-8 md:h-8 rounded-full border-2 flex items-center justify-center mr-3 ${quizState.basic.answers[quizState.basic.currentQuestion] === idx ? 'border-indigo-500 bg-indigo-500 text-white' : 'border-gray-300'}">
                                                ${String.fromCharCode(65 + idx)}
                                            </div>
                                            <span class="flex-1 text-gray-800 text-sm md:text-base">${option}</span>
                                            ${quizState.basic.answers[quizState.basic.currentQuestion] === idx ? 
                                                '<span class="text-indigo-600 ml-2">âœ“</span>' : ''}
                                        </div>
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-between pt-6 border-t border-gray-200">
                    <button onclick="prevQuestion('basic')" ${quizState.basic.currentQuestion === 0 ? 'disabled' : ''} 
                            class="px-4 md:px-6 py-2 md:py-3 rounded-lg font-medium text-sm md:text-base ${quizState.basic.currentQuestion === 0 ? 'text-gray-400 cursor-not-allowed' : 'text-indigo-600 hover:bg-indigo-50'}">
                        â† ä¸Šä¸€é¡Œ
                    </button>
                    
                    <button onclick="nextQuestion('basic')" ${quizState.basic.answers[quizState.basic.currentQuestion] === null ? 'disabled' : ''} 
                            class="px-4 md:px-8 py-2 md:py-3 rounded-lg font-semibold text-sm md:text-base ${quizState.basic.answers[quizState.basic.currentQuestion] === null ? 'bg-gray-100 text-gray-400 cursor-not-allowed' : 'btn-primary'}">
                        ${quizState.basic.currentQuestion === 15 ? 'å®Œæˆæ¸¬é©—' : 'ä¸‹ä¸€é¡Œ â†’'}
                    </button>
                </div>
            </div>
        </div>
    `;
}

// ==================== å°ˆå®¶æ¸¬é©—æ¸²æŸ“ ====================
function renderExpertQuiz() {
    const totalQuestions = 69;
    const q = EXPERT_QUESTIONS[quizState.expert.currentQuestion];
    const answered = quizState.expert.answers.filter(a => a !== null).length;
    const progress = (answered / totalQuestions) * 100;
    
    return `
        <div class="fade-in quiz-container">
            <div class="mb-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl md:text-2xl font-bold text-gray-800">å°ˆå®¶æ¸¬é©—</h2>
                    <span class="bg-gradient-to-r from-purple-100 to-pink-100 text-purple-800 px-3 py-1 rounded-full font-semibold text-sm">${answered}/${totalQuestions} é¡Œ</span>
                </div>
                
                <div class="mb-6">
                    <div class="flex justify-between text-sm text-gray-600 mb-2">
                        <span>æ¸¬é©—é€²åº¦</span>
                        <span>${Math.round(progress)}%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${progress}%"></div>
                    </div>
                </div>
                
                <div class="mb-8 p-4 md:p-6 bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl border border-purple-100">
                    <div class="flex items-start">
                        <div class="w-10 h-10 md:w-12 md:h-12 rounded-xl bg-gradient-to-r from-purple-100 to-pink-100 flex items-center justify-center mr-3 md:mr-4">
                            <span class="text-lg md:text-xl font-bold text-purple-700">${quizState.expert.currentQuestion + 1}</span>
                        </div>
                        <div class="flex-1">
                            <h3 class="text-lg md:text-xl font-semibold text-gray-800 mb-3">${q.text}</h3>
                            <div class="space-y-2 md:space-y-3">
                                ${q.options.map((option, idx) => `
                                    <button onclick="selectAnswer(${idx}, 'expert')" 
                                            class="w-full text-left p-3 md:p-4 rounded-xl border-2 transition-all duration-200 ${quizState.expert.answers[quizState.expert.currentQuestion] === idx ? 'border-purple-500 bg-purple-50 shadow-md' : 'border-gray-200 hover:border-purple-300 hover:bg-gray-50'}">
                                        <div class="flex items-center">
                                            <div class="w-6 h-6 md:w-8 md:h-8 rounded-full border-2 flex items-center justify-center mr-3 ${quizState.expert.answers[quizState.expert.currentQuestion] === idx ? 'border-purple-500 bg-purple-500 text-white' : 'border-gray-300'}">
                                                ${String.fromCharCode(65 + idx)}
                                            </div>
                                            <span class="flex-1 text-gray-800 text-sm md:text-base">${option}</span>
                                            ${quizState.expert.answers[quizState.expert.currentQuestion] === idx ? 
                                                '<span class="text-purple-600 ml-2">âœ“</span>' : ''}
                                        </div>
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-between pt-6 border-t border-gray-200">
                    <button onclick="prevQuestion('expert')" ${quizState.expert.currentQuestion === 0 ? 'disabled' : ''} 
                            class="px-4 md:px-6 py-2 md:py-3 rounded-lg font-medium text-sm md:text-base ${quizState.expert.currentQuestion === 0 ? 'text-gray-400 cursor-not-allowed' : 'text-purple-600 hover:bg-purple-50'}">
                        â† ä¸Šä¸€é¡Œ
                    </button>
                    
                    <button onclick="nextQuestion('expert')" ${quizState.expert.answers[quizState.expert.currentQuestion] === null ? 'disabled' : ''} 
                            class="px-4 md:px-8 py-2 md:py-3 rounded-lg font-semibold text-sm md:text-base ${quizState.expert.answers[quizState.expert.currentQuestion] === null ? 'bg-gray-100 text-gray-400 cursor-not-allowed' : 'bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:opacity-90'}">
                        ${quizState.expert.currentQuestion === 68 ? 'å®Œæˆæ¸¬é©—' : 'ä¸‹ä¸€é¡Œ â†’'}
                    </button>
                </div>
            </div>
        </div>
    `;
}

// ==================== Proæ¸¬é©—æ¸²æŸ“ ====================
function renderProQuiz() {
    const totalQuestions = 120;
    const q = PRO_QUESTIONS[quizState.pro.currentQuestion];
    const answered = quizState.pro.answers.filter(a => a !== null).length;
    const progress = (answered / totalQuestions) * 100;
    
    return `
        <div class="fade-in quiz-container">
            <div class="mb-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl md:text-2xl font-bold text-gray-800">ç²¾æº– Pro æ¸¬é©—</h2>
                    <span class="bg-gradient-to-r from-amber-100 to-orange-100 text-amber-800 px-3 py-1 rounded-full font-semibold text-sm">${answered}/${totalQuestions} é¡Œ</span>
                </div>
                
                <div class="mb-6">
                    <div class="flex justify-between text-sm text-gray-600 mb-2">
                        <span>æ¸¬é©—é€²åº¦</span>
                        <span>${Math.round(progress)}%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${progress}%"></div>
                    </div>
                </div>
                
                <div class="mb-8 p-4 md:p-6 bg-gradient-to-r from-amber-50 to-orange-50 rounded-2xl border border-amber-100">
                    <div class="flex items-start">
                        <div class="w-10 h-10 md:w-12 md:h-12 rounded-xl bg-gradient-to-r from-amber-100 to-orange-100 flex items-center justify-center mr-3 md:mr-4">
                            <span class="text-lg md:text-xl font-bold text-amber-700">${quizState.pro.currentQuestion + 1}</span>
                        </div>
                        <div class="flex-1">
                            <h3 class="text-lg md:text-xl font-semibold text-gray-800 mb-3">${q.text}</h3>
                            <div class="space-y-2 md:space-y-3">
                                ${q.options.map((option, idx) => `
                                    <button onclick="selectAnswer(${idx}, 'pro')" 
                                            class="w-full text-left p-3 md:p-4 rounded-xl border-2 transition-all duration-200 ${quizState.pro.answers[quizState.pro.currentQuestion] === idx ? 'border-amber-500 bg-amber-50 shadow-md' : 'border-gray-200 hover:border-amber-300 hover:bg-gray-50'}">
                                        <div class="flex items-center">
                                            <div class="w-6 h-6 md:w-8 md:h-8 rounded-full border-2 flex items-center justify-center mr-3 ${quizState.pro.answers[quizState.pro.currentQuestion] === idx ? 'border-amber-500 bg-amber-500 text-white' : 'border-gray-300'}">
                                                ${String.fromCharCode(65 + idx)}
                                            </div>
                                            <span class="flex-1 text-gray-800 text-sm md:text-base">${option}</span>
                                            ${quizState.pro.answers[quizState.pro.currentQuestion] === idx ? 
                                                '<span class="text-amber-600 ml-2">âœ“</span>' : ''}
                                        </div>
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-between pt-6 border-t border-gray-200">
                    <button onclick="prevQuestion('pro')" ${quizState.pro.currentQuestion === 0 ? 'disabled' : ''} 
                            class="px-4 md:px-6 py-2 md:py-3 rounded-lg font-medium text-sm md:text-base ${quizState.pro.currentQuestion === 0 ? 'text-gray-400 cursor-not-allowed' : 'text-amber-600 hover:bg-amber-50'}">
                        â† ä¸Šä¸€é¡Œ
                    </button>
                    
                    <button onclick="nextQuestion('pro')" ${quizState.pro.answers[quizState.pro.currentQuestion] === null ? 'disabled' : ''} 
                            class="px-4 md:px-8 py-2 md:py-3 rounded-lg font-semibold text-sm md:text-base ${quizState.pro.answers[quizState.pro.currentQuestion] === null ? 'bg-gray-100 text-gray-400 cursor-not-allowed' : 'bg-gradient-to-r from-amber-600 to-orange-600 text-white rounded-lg hover:opacity-90'}">
                        ${quizState.pro.currentQuestion === 119 ? 'å®Œæˆæ¸¬é©—' : 'ä¸‹ä¸€é¡Œ â†’'}
                    </button>
                </div>
            </div>
        </div>
    `;
}

// ==================== æ¸¬é©—åŠŸèƒ½ ====================
function selectAnswer(answerIndex, quizType) {
    quizState[quizType].answers[quizState[quizType].currentQuestion] = answerIndex;
    renderContent();
}

function prevQuestion(quizType) {
    if (quizState[quizType].currentQuestion > 0) {
        quizState[quizType].currentQuestion--;
        renderContent();
    }
}

function nextQuestion(quizType) {
    if (quizState[quizType].answers[quizState[quizType].currentQuestion] === null) {
        alert('è«‹é¸æ“‡ä¸€å€‹ç­”æ¡ˆ');
        return;
    }
    
    const totalQuestions = quizType === 'basic' ? 16 : 
                          quizType === 'expert' ? 69 : 120;
    
    if (quizState[quizType].currentQuestion < totalQuestions - 1) {
        quizState[quizType].currentQuestion++;
        renderContent();
    } else {
        calculateResults(quizType);
        quizState[quizType].completed = true;
        renderContent();
    }
}

// ==================== çµæœè¨ˆç®— ====================
function calculateResults(quizType) {
    const questions = quizType === 'basic' ? BASIC_QUESTIONS : 
                     quizType === 'expert' ? EXPERT_QUESTIONS : PRO_QUESTIONS;
    const answers = quizState[quizType].answers;
    
    const scores = { E: 0, I: 0, S: 0, N: 0, T: 0, F: 0, J: 0, P: 0 };
    
    questions.forEach((question, index) => {
        const answer = answers[index];
        if (answer !== null) {
            const dichotomy = question.dichotomy;
            if (answer === 0) scores[dichotomy[0]]++;
            else if (answer === 1) scores[dichotomy[1]]++;
        }
    });
    
    const mbtiType = 
        (scores.E >= scores.I ? 'E' : 'I') +
        (scores.S >= scores.N ? 'S' : 'N') +
        (scores.T >= scores.F ? 'T' : 'F') +
        (scores.J >= scores.P ? 'J' : 'P');
    
    const descriptions = {
        'ISTJ': { title: 'ç‰©æµå¸« (Logistician)', desc: 'å‹™å¯¦ã€äº‹å¯¦ç‚ºä¸­å¿ƒï¼Œå¯é æ€§ç„¡èˆ‡å€«æ¯”ã€‚ä»–å€‘æ˜¯å‚³çµ±çš„å®ˆè­·è€…ï¼Œé‡è¦–çµæ§‹å’Œç§©åºã€‚' },
        'ISFJ': { title: 'å®ˆè¡›è€… (Defender)', desc: 'éå¸¸å¿ èª å’Œé«”è²¼ï¼Œéš¨æ™‚æº–å‚™ä¿è­·æ‰€æ„›çš„äººã€‚ä»–å€‘æ˜¯è¬™éœä¸”å‹¤å¥®çš„åŠ©äººè€…ï¼Œå°‡æœå‹™ä»–äººè¦–ç‚ºè‡ªå·±çš„ä½¿å‘½ã€‚' },
        'INFJ': { title: 'æå€¡è€… (Advocate)', desc: 'å®‰éœè€Œç¥ç§˜ï¼Œä½†é¼“èˆäººå¿ƒä¸”ä¸æ‡ˆçš„ç†æƒ³ä¸»ç¾©è€…ã€‚ä»–å€‘æ“æœ‰å¼·çƒˆçš„é“å¾·æ„Ÿå’Œé è¦‹ã€‚' },
        'INTJ': { title: 'å»ºç¯‰å¸« (Architect)', desc: 'å¯Œæœ‰æƒ³åƒåŠ›å’Œæˆ°ç•¥æ€æƒ³ï¼Œå°ä¸€åˆ‡éƒ½æœ‰ä¸€å€‹è¨ˆåŠƒã€‚ä»–å€‘æ˜¯çŸ¥è­˜çš„è¿½æ±‚è€…ï¼Œé«˜åº¦ç¨ç«‹ã€‚' },
        'ISTP': { title: 'æ¢éšªå®¶ (Virtuoso)', desc: 'å¤§è†½è€Œå‹™å¯¦çš„å¯¦é©—è€…ï¼Œæ“…é•·ä½¿ç”¨å·¥å…·å’Œè¦ªæ‰‹è§£æ±ºå•é¡Œã€‚ä»–å€‘å–œæ­¡è‡ªç”±å’Œå³æ™‚çš„è¡Œå‹•ã€‚' },
        'ISFP': { title: 'è—è¡“å®¶ (Adventurer)', desc: 'éˆæ´»ã€è¿·äººçš„è—è¡“å®¶ï¼Œéš¨æ™‚æº–å‚™æ¢ç´¢å’Œé«”é©—æ–°äº‹ç‰©ã€‚ä»–å€‘æ´»åœ¨ç•¶ä¸‹ï¼Œé‡è¦–ç¾æ„Ÿã€‚' },
        'INFP': { title: 'èª¿åœè€… (Mediator)', desc: 'è©©æ„ã€å–„è‰¯ä¸”ç„¡ç§çš„åˆ©ä»–ä¸»ç¾©è€…ï¼Œç¸½æ˜¯ç†±è¡·æ–¼åŠ©äººã€‚ä»–å€‘ç”±æ ¸å¿ƒåƒ¹å€¼è§€å’Œå¥½å¥‡å¿ƒé©…å‹•ã€‚' },
        'INTP': { title: 'é‚è¼¯å­¸å®¶ (Logician)', desc: 'å‰µæ–°è€…ï¼Œå°çŸ¥è­˜æœ‰è‘—æ°¸ä¸æ»¿è¶³çš„æ¸´æœ›ã€‚ä»–å€‘æ“…é•·åˆ†æå’ŒæŠ½è±¡æ€ç¶­ï¼Œäº«å—ç´”ç²¹çš„æ™ºåŠ›æ¢ç´¢ã€‚' },
        'ESTP': { title: 'ä¼æ¥­å®¶ (Entrepreneur)', desc: 'è°æ˜ã€ç²¾åŠ›å……æ²›ï¼ŒçœŸæ­£äº«å—æ´»åœ¨é‚Šç·£ã€‚ä»–å€‘æ˜¯ç¤¾äº¤çš„å¯¦å¹¹å®¶ï¼Œå°ˆæ³¨æ–¼ç•¶å‰çš„çµæœã€‚' },
        'ESFP': { title: 'è¡¨æ¼”è€… (Entertainer)', desc: 'è‡ªç™¼æ€§ã€ç²¾åŠ›å……æ²›ä¸”ç†±æƒ…æ´‹æº¢çš„ç”Ÿæ´»å®¶ï¼Œç•¶ä»–å€‘åœ¨å ´æ™‚ï¼Œä¸–ç•Œä¸æœƒæ²‰æ‚¶ã€‚ä»–å€‘å–œæ­¡æˆç‚ºç„¦é»ã€‚' },
        'ENFP': { title: 'ç«¶é¸è€… (Campaigner)', desc: 'ç†±æƒ…ã€å¯Œæœ‰å‰µæ„å’Œç¤¾äº¤èƒ½åŠ›ï¼Œæ°¸é èƒ½æ‰¾åˆ°å¾®ç¬‘çš„ç†ç”±ã€‚ä»–å€‘å……æ»¿æ´»åŠ›ï¼Œå°‹æ±‚èˆ‡ä»–äººçš„æ·±åˆ»é€£çµã€‚' },
        'ENTP': { title: 'è¾¯è«–å®¶ (Debater)', desc: 'è°æ˜ä¸”å¥½å¥‡çš„æ€æƒ³å®¶ï¼Œç¸½æ˜¯å¿ä¸ä½å°ç¾ç‹€æå‡ºè³ªç–‘ã€‚ä»–å€‘å–œæ­¡æ™ºåŠ›æŒ‘æˆ°å’Œè…¦åŠ›æ¿€ç›ªã€‚' },
        'ESTJ': { title: 'ç¸½ç¶“ç† (Executive)', desc: 'å„ªç§€çš„ç®¡ç†è€…ï¼Œæ“…é•·ç®¡ç†äº‹å‹™æˆ–äººå“¡ã€‚ä»–å€‘æ˜¯å‚³çµ±çš„å¯¦æ–½è€…ï¼Œé‡è¦–æ•ˆç‡å’Œè²¬ä»»ã€‚' },
        'ESFJ': { title: 'åŸ·æ”¿å®˜ (Consul)', desc: 'éå¸¸é—œå¿ƒä»–äººï¼Œå–„æ–¼ç¤¾äº¤ï¼Œç†±è¡·æ–¼å¹«åŠ©ã€‚ä»–å€‘æ˜¯åœ˜éšŠçš„åŸºçŸ³ï¼Œé‡è¦–ç¤¾æœƒè¦ç¯„ã€‚' },
        'ENFJ': { title: 'ä¸»äººå…¬ (Protagonist)', desc: 'é­…åŠ›åè¶³ã€é¼“èˆäººå¿ƒçš„é ˜å°è€…ï¼Œèƒ½å¤ æ¿€ç™¼è½çœ¾ã€‚ä»–å€‘å¯Œæœ‰æ¿€æƒ…ï¼Œè‡´åŠ›æ–¼å¯¦ç¾ç©æ¥µçš„æ”¹è®Šã€‚' },
        'ENTJ': { title: 'æŒ‡æ®å®˜ (Commander)', desc: 'å¤§è†½ã€å¯Œæœ‰æƒ³åƒåŠ›ä¸”æ„å¿—å …å®šçš„é ˜å°è€…ï¼Œä»–å€‘ç¸½èƒ½æ‰¾åˆ°æ–¹æ³•é”æˆç›®æ¨™ã€‚ä»–å€‘æ˜¯å¤©ç”Ÿçš„æ±ºç­–è€…ã€‚' }
    };
    
    const desc = descriptions[mbtiType] || { title: 'æ¢ç´¢è€…', desc: 'æ‚¨çš„æ€§æ ¼é¡å‹é¡¯ç¤ºç¨ç‰¹çš„çµ„åˆï¼Œç¹¼çºŒæ¢ç´¢è‡ªæˆ‘æ½›èƒ½å§ï¼' };
    
    quizState[quizType].result = {
        type: mbtiType,
        title: desc.title,
        description: desc.desc,
        scores: scores,
        dimensions: [
            { label: 'å¤–å‘(E) / å…§å‘(I)', pct: Math.round((scores.E / (scores.E + scores.I || 1)) * 100), left: 'å¤–å‘', right: 'å…§å‘' },
            { label: 'å¯¦æ„Ÿ(S) / ç›´è¦º(N)', pct: Math.round((scores.S / (scores.S + scores.N || 1)) * 100), left: 'å¯¦æ„Ÿ', right: 'ç›´è¦º' },
            { label: 'æ€è€ƒ(T) / æƒ…æ„Ÿ(F)', pct: Math.round((scores.T / (scores.T + scores.F || 1)) * 100), left: 'æ€è€ƒ', right: 'æƒ…æ„Ÿ' },
            { label: 'åˆ¤æ–·(J) / æ„ŸçŸ¥(P)', pct: Math.round((scores.J / (scores.J + scores.P || 1)) * 100), left: 'åˆ¤æ–·', right: 'æ„ŸçŸ¥' }
        ]
    };
}

// ==================== çµæœé é¢ ====================
function renderResults(quizType) {
    const result = quizState[quizType].result;
    if (!result) return '<div class="text-center py-12">è¨ˆç®—çµæœä¸­...</div>';
    
    const isPro = quizType === 'pro';
    const isExpert = quizType === 'expert';
    const quizName = isPro ? 'Proç´šæ¸¬é©—' : isExpert ? 'å°ˆå®¶æ¸¬é©—' : 'åŸºæœ¬æ¸¬é©—';
    const quizQuestions = isPro ? '120é¡Œ' : isExpert ? '69é¡Œ' : '16é¡Œ';
    
    const bgColor = isPro ? 'from-amber-100 to-orange-100' : 
                   isExpert ? 'from-purple-100 to-pink-100' : 'from-green-100 to-emerald-100';
    const textColor = isPro ? 'text-amber-700' : 
                     isExpert ? 'text-purple-700' : 'text-green-700';
    const borderColor = isPro ? 'border-amber-200' : 
                       isExpert ? 'border-purple-200' : 'border-green-200';
    
    // åˆ†äº«æ–‡å­—
    const shareText = `æˆ‘å‰›å®ŒæˆMBTI ${quizName}ï¼Œçµæœæ˜¯${result.type}ï¼ˆ${result.title}ï¼‰ï¼å¿«ä¾†æ¸¬è©¦ä½ çš„æ€§æ ¼é¡å‹å§ï¼`;
    const shareUrl = window.location.href;
    
    return `
        <div class="fade-in result-container">
            <!-- ä¸»è¦çµæœå¡ç‰‡ -->
            <div class="bg-gradient-to-r ${bgColor} p-4 md:p-6 rounded-2xl border ${borderColor} mb-4">
                <div class="text-center mb-6">
                    <div class="w-20 h-20 md:w-24 md:h-24 mx-auto mb-4 rounded-full bg-white flex items-center justify-center shadow-lg">
                        <span class="text-3xl md:text-4xl font-bold ${textColor}">${result.type}</span>
                    </div>
                    <h2 class="text-xl md:text-2xl font-bold text-gray-800 mb-2">${result.title}</h2>
                    <p class="text-gray-600 text-sm md:text-base">${result.description}</p>
                    <p class="text-sm text-gray-500 mt-2">åŸºæ–¼${quizQuestions}æ·±åº¦åˆ†æ</p>
                </div>
                
                <!-- å››å€‹ç¶­åº¦é¡¯ç¤º -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-6">
                    ${result.dimensions.map(dim => `
                        <div class="bg-white p-4 rounded-xl border border-gray-200">
                            <div class="flex justify-between items-center mb-2">
                                <h4 class="font-bold text-gray-800 text-sm">${dim.label}</h4>
                                <span class="font-bold ${textColor}">${dim.pct}%</span>
                            </div>
                            <div class="mb-2">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${dim.pct}%"></div>
                                </div>
                            </div>
                            <div class="flex justify-between text-xs text-gray-600">
                                <span>${dim.left}</span>
                                <span>${dim.right}</span>
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>
            
            <!-- æŒ‰éˆ•å€ -->
            <div class="flex justify-center space-x-3 mt-4">
                <button onclick="restartQuiz('${quizType}')" 
                        class="px-4 py-2 border-2 ${isPro ? 'border-amber-300 text-amber-700 hover:bg-amber-50' : isExpert ? 'border-purple-300 text-purple-700 hover:bg-purple-50' : 'border-indigo-300 text-indigo-700 hover:bg-indigo-50'} font-semibold rounded-lg text-sm">
                    é‡æ–°æ¸¬è©¦
                </button>
                <button onclick="switchTab('basic')" class="px-4 py-2 btn-primary text-sm">
                    è¿”å›é¦–é 
                </button>
            </div>
        </div>
    `;
}

function restartQuiz(quizType) {
    quizState[quizType] = {
        currentQuestion: 0,
        answers: new Array(quizType === 'basic' ? 16 : quizType === 'expert' ? 69 : 120).fill(null),
        completed: false,
        result: null
    };
    renderContent();
}

// ==================== åˆå§‹åŒ– ====================
function init() {
    renderContent();
    
    // åˆå§‹è¼‰å…¥Googleå»£å‘Š
    setTimeout(loadGoogleAds, 1000);
    
    // ç›£è½é é¢å¯è¦‹æ€§è®ŠåŒ–
    document.addEventListener('visibilitychange', () => {
        if (!document.hidden) {
            loadGoogleAds();
        }
    });
}

// é é¢è¼‰å…¥
document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
